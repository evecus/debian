FROM nginx:alpine

RUN apk add --no-cache git wget cronie tzdata ca-certificates

# 默认时区，可通过 -e TZ=... 覆盖，entrypoint.sh 会在运行时应用
ENV TZ=Asia/Shanghai

# nginx 配置
COPY nginx.conf /etc/nginx/nginx.conf

# 前端页面（独立目录，不会被同步覆盖）
RUN mkdir -p /app
COPY index.html /app/index.html

# 启动脚本
COPY entrypoint_no.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh

VOLUME ["/data"]

EXPOSE 8080

ENTRYPOINT ["/entrypoint.sh"]
